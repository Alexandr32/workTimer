<!doctype html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <script type="text/javascript" src="vanilla-tilt.js"></script>
</head>
<body>

<template id="templateDrop">
    <div class="drop"></div>
</template>

<div class="timer">
    <div class="text-label">
        До конца рабочего дня осталось:
    </div>

    <div class="time">

        <div class="circle">
            <div id="hour" class="title">
                00
            </div>
            <div class="name">
                Часы
            </div>

            <div class="dots hh-dot dot-red"></div>

            <svg  height='100%' width='100%' class="svg">
                <circle cx="100" cy="100" r="70"></circle>
            </svg>

            <svg  height='100%' width='100%' class="svg red" id="hh-line">
                <circle cx="100" cy="100" r="70"></circle>
            </svg>

        </div>

        <div class="circle">

            <div id="minute" class="title">
                00
            </div>
            <div class="name">
                Минуты
            </div>

            <div class="dots hh-dot dot-yellow"></div>

            <svg  height='100%' width='100%' class="svg">
                <circle cx="100" cy="100" r="70"></circle>
            </svg>

            <svg  height='100%' width='100%' class="svg yellow" id="mm-line">
                <circle cx="100" cy="100" r="70"></circle>
            </svg>
        </div>

        <div class="circle">

            <div id="second" class="title">
                00
            </div>
            <div class="name">
                Секунды
            </div>

            <div class="dots hh-dot dot-green"></div>

            <svg  height='100%' width='100%' class="svg">
                <circle cx="100" cy="100" r="70"></circle>
            </svg>

            <svg  height='100%' width='100%' class="svg green" id="ss-line">
                <circle cx="100" cy="100" r="70"></circle>
            </svg>
        </div>

    </div>
</div>

</body>
</html>

<script>

    VanillaTilt.init(document.querySelectorAll('.timer'), {
        max: 25,
        speed: 400,
        scale: 1.2,
        //glare: true,
        //"max-glare": 0.5
    });

    updateUI()

    setInterval(() => {
        updateUI()
    }, 1000)

    function updateUI() {
        const hourElement = document.getElementById('hour')
        const minuteElement = document.getElementById('minute')
        const secondElement = document.getElementById('second')

        const currentHourElement = new Date().getHours()
        const currentMinuteElement = new Date().getMinutes()
        const currentSecondElement = new Date().getSeconds()

        hourElement.innerHTML = currentHourElement
        minuteElement.innerHTML = currentMinuteElement
        secondElement.innerHTML = currentSecondElement

        const hhLine = document.getElementById('hh-line')
        const mmLine = document.getElementById('mm-line')
        const ssLine = document.getElementById('ss-line')

        hhLine.style.strokeDashoffset = 440 - (440 * currentHourElement) / 12
        mmLine.style.strokeDashoffset = 440 - (440 * currentMinuteElement) / 60
        ssLine.style.strokeDashoffset = 440 - (440 * currentSecondElement) / 60

        const dotRed = document.getElementsByClassName('dot-red')[0]
        const dotYellow = document.getElementsByClassName('dot-yellow')[0]
        const dotGreen = document.getElementsByClassName('dot-green')[0]

        dotRed.style.transform = `rotate(${currentHourElement * 30}deg)`
        dotYellow.style.transform = `rotate(${currentMinuteElement * 6}deg)`
        dotGreen.style.transform = `rotate(${currentSecondElement * 6}deg)`
    }

    rain()

    function rain() {
        const body = document.querySelector('body')
        const amount = 80

        for (let i = 0; i < amount; i++) {

            const drop = templateDrop.content.cloneNode(true).children[0]

            const size = Math.random() * 5
            const posX = Math.floor(Math.random() * window.innerWidth)
            const delay = Math.random() * -20
            const duration = Math.random() * -20

            drop.style.width = `${0.2 + size}px`
            drop.style.left = `${posX}px`
            drop.style.animationDelay = `${delay}s`
            drop.style.animationDuration = `1${duration}s`

            body.append(drop)
        }
    }


</script>